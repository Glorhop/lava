# Stripped down fvp job

device_type: fvp
job_name: fvp job with ramdisk on disk image

timeouts:
  connection:
    minutes: 3
  job:
    minutes: 10
  actions:
    auto-login-action:
      minutes: 5

priority: medium
visibility: public

actions:
- deploy:
    to: fvp
    images:
      disk:
        url: http://example.com/disk.img
        overlays:
        # Zero based index so this is second partition
        - partition: 1
          ramdisk: ramdisk-busybox.img
      # Add extra binaries

- boot:
    method: fvp
    prompts:
    - 'root@lava '
    image:
      name: "my_fvp_image"
    fvp_image: /path/to/FVP_Image
    timeout:
      minutes: 5
    console_string: 'terminal_0: Listening for serial connection on port (?P<PORT>\d+)'
    fvp_license_variable: insert_license
    fvp_arguments: |-
      -C board.virtioblockdevice.image_path={DISK}
    # Add extra arguments
    prompts:
    - '/ #'

- test:
    timeout:
      minutes: 5
    definitions:
    - repository:
        metadata:
          format: Lava-Test Test Definition 1.0
          name: docker-connection-test
          description: '"Check fvp network connection"'
          os:
          - busybox
          scope:
          - functional
        run:
          steps:
          - ifconfig
      from: inline
      name: docker-test-run
      path: inline/docker-test-run.yaml
